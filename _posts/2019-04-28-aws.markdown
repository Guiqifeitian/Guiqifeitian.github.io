---
categories: blog
title: "AWS"
date: '2019-04-28 09:19:18'
published: True
layout: post
---

#### EC2的EBS卷和实例存储卷的区别是什么？EBS卷支持动态缩容扩容么？单EBS卷最大支持多大空间？

EBS卷创建的实例支持停止和重启，且可以有多种方法恢复；实例存储卷创建的实例不支持停止和重启，一旦停止，无法恢复该实例。EBS卷支持动态扩容和缩容。单EBS卷最大支持16T空间

#### 什么是 IAM角色，为什么在EC2上最好使用IAM角色来管理对AWS服务的访问？

IAM 角色是可在账户中创建的一种具有特定权限的 IAM 身份。IAM 角色类似于 IAM 用户，可在不共享您的安全证书的情况下允许其他用户、服务和应用程序使用您的 Amazon VPC 资源。角色可提供临时权限供应用程序在调用其他AWS资源时使用。当用户启动EC2实例时，可指定要与实例关联的IAM角色。然后，实例上运行的应用程序可使用角色提供的临时凭证对API请求进行签名。

[IAM策略结构](https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/iam-policy-structure.html)

#### 简单介绍S3中的存储桶和对象键

存储于 Amazon S3 中的每个对象都存储在存储桶中，对象键是创建对象时指定的键名称，它在存储桶中唯一地标识该对象。

[存储对象](https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/dev/storage-class-intro.html)

#### 简单介绍ELB和AutoScaling

ELB是负载均衡器，包括ALB（应用负载均衡器，支持HTTP负载均衡）、NLB（网络负载均衡器、支持TCP负载均衡）、CLB（经典负载均衡器、支持HTTP和TCP负载均衡），AutoScaling是用于保证有一定数量的ec2实例，也可以动态扩展示例数量，保证在高负载的时候服务的性能。

##### 跨区域负载均衡

启用跨区域负载均衡后，流量会在各个可用区的目标之间均分，禁用后，流量先是在各个可用区的负载均衡器之间均分，再在各自的可用区之间均分。ALB始终启用夸区域负载均衡。

##### 路由算法

ALB:负载均衡器节点会按照优先级顺序评估侦听器规则以确定应用那个规则，然后使用轮询算法从目标组中选择一个目标以实施规则
NLB:根据五元组和tcp序号，使用流式哈希算法从目标组中为默认规则选择一个目标
CLB:接受请求的负载均衡器节点将利用不同算法来选择已注册的实例。它对 TCP 侦听器使用轮询路由算法，对 HTTP 和 HTTPS 侦听器使用最少未完成请求路由算法。

##### HTTP

CLB和ALB支持多路复用

[负载均衡器](https://docs.aws.amazon.com/zh_cn/elasticloadbalancing/latest/userguide/what-is-load-balancing.html)

#### VPC

创建VPC时，使用CIDR形式指定IPv4范围

##### 联网组件

###### 网络接口

就是网卡。在VPC中每个示例有一个主网络接口，及默认网络接口，无法从实例断开网络接口，但可以创建网络接口，挂载到实例。

###### 路由表

+ VPC有一个隐式路由器
+ VPC会自动生成主路由表
+ VPC中的子网会默认与主路由表建立隐式关联
+ 只能新建一个路由表替换主路由表，不能直接删除主路由表

使用最长前缀匹配流量

###### Internet网关

###### 仅出口Internet网关

仅出口 Internet 网关是一种横向扩展、支持冗余且高度可用的 VPC 组件，它能够实现从 VPC 中的实例经由 IPv6 到 Internet 的出站通信，并防止 Internet 发起与您的实例的 IPv6 连接。

###### NAT

您可以使用网络地址转换 (NAT) 网关允许私有子网中的实例连接到 Internet 或其他 AWS 服务，但阻止 Internet 发起与这些实例的连接。

+ 指定NAT网管所在的公有子网之中
+ 指定NAT网关的弹性IP地址
+ 更新私有子网的关联的路由表，将Internet绑定流量指向该网关

###### NAT实例

通过AMI启动NAT实例，相比较NAT网关，NAT实例支持自定义配置端口转发，随时更新弹性IP，等

###### DHCP选项集

非默认的VPC中启用的实例属于私有实例，即没有公有ipv4地址，默认被分配一个无法解析的主机名。
DHCP选项集支持的选项如下

+ 域名服务器DNS，最多四台，默认指定的是AmazonProvidedDNS，169.254.169.253
+ 域名
+ 网络时间协议服务器 NTP
+ NetBios名称服务器
+ NetBios节点类型

###### DNS

Amazon 提供的私有（内部）DNS 主机名解析为实例的私有 IPv4 地址，并对 us-east-1 区域采用 ip-private-ipv4-address.ec2.internal 形式，对其他区域采用 ip-private-ipv4-address.region.compute.internal 形式（其中 private-ipv4-address 是反向查找 IP 地址）。
对于 us-east-1 区域，公有（外部）DNS 主机名采用 ec2-public-ipv4-address.compute-1.amazonaws.com 形式，对于其他区域，则采用 ec2-public-ipv4-address.region.compute.amazonaws.com 形式。

###### 弹性IP

弹性IP可以与VPC中的任何实例或者网关接口关联，借助弹性 IP 地址，可以迅速将地址重新映射到 VPC 中的另一个实例，从而屏蔽实例故障。注意，将弹性 IP 地址与网络接口关联，而不直接与实例关联的优势在于，只需一步，即可将网络接口的所有属性从一个实例移至另一个。

###### VPC终端节点

终端节点是虚拟设备。这些是水平扩展、冗余且具备高可用性的 VPC 组件，通过使用这些组件，可以在 VPC 中的实例与服务之间进行通信，而不会对网络通信带来可用性风险或带宽限制。

分为接口终端节点 和 网关终端节点

###### ClassicLink

ClassicLink 允许您将 EC2-Classic 实例链接到账户中位于同一区域内的 VPC。这样，您可以将 VPC 安全组与 EC2-Classic 实例关联，以便允许 EC2-Classic 实例与 VPC 中的实例使用私有 IPv4 地址进行通信。通过 ClassicLink，无需使用公有 IPv4 地址或弹性 IP 地址即可在这些平台中的实例之间进行通信

##### VPN连接

###### AWS Site-to-Site VPN

###### AWS客户端VPN

###### AWS VPN CloudHub

###### 第三方软件VPN设备

[VPC](https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/what-is-amazon-vpc.html)

#### Amazon SQS

+ 安全性 – 您可以控制谁能向 Amazon SQS 队列发送消息以及谁能从队列接收消息。

+ 利用 服务器端加密 (SSE)，可以使用 AWS Key Management Service (AWS KMS) 中托管的密钥保护队列中消息的内容，从而通过此方式传输敏感数据。

+ 持久性 – 为确保消息的安全，Amazon SQS 将消息存储在多个服务器上。标准队列支持至少一次消息传送，而 FIFO 队列支持仅一次消息处理。

+ 可用性 – Amazon SQS 使用冗余基础设施为生成和使用消息提供高度并发的消息访问和高可用性。

+ 可扩展性 – Amazon SQS 可独立处理各个缓冲的请求，并可透明扩展以处理任何负载增加或峰值，无需任何预配置指令。

+ 可靠性 – Amazon SQS 在处理期间锁定消息，以便多个生成者可同时发送消息，多个使用者可同时接收消息。

+ 自定义 – 您的队列不必完全相同—例如，您可以设置队列的默认延迟。可以使用 Amazon Simple Storage Service (Amazon S3) 或 Amazon DynamoDB 存储大于 256 KB 的消息的内容，Amazon SQS 保留指向 Amazon S3 对象的指针，您也可以将一个大消息拆分为几个小消息。

##### 标准队列和FIFO队列

标准队列：所有区域可用，无线吞吐量，至少传送一次，最大努力排序

FIFO队列：部分区域可用，高吞吐量（3000条每秒），仅传输一次，先进先出传递

###### 标准队列

在很多情况下使用标准消息队列（只要应用程序能够处理多次到达和不按顺序到达的消息），例如：

* 将实时用户请求从密集型后台工作中分离 – 让用户在调整媒体大小或对媒体编码时上传媒体。

* 将任务分配给多个工作程序节点 – 处理大量信用卡验证请求。

* 将消息分批以便进一步处理 – 计划要添加到数据库的多个条目。

至少传递一次：讲程序设计为幂等应用程序，以便在多次接收同一个消息时结果不受不利影响

通过短轮询使用消息：当通过短轮询从队列中使用消息时，Amazon SQS 会对其一部分服务器（基于加权随机分布）进行采样，并且仅从这些服务器返回消息。因此，特定接收请求可能不会返回您的所有消息。但是，如果您的队列中的消息少于 1,000 条，一个后续请求将返回您的消息。如果继续从您的队列中使用消息，则 Amazon SQS 会对其所有服务器进行采样，然后您将收到您的所有消息。

![Amazon SQS](https://docs.aws.amazon.com/zh_cn/AWSSimpleQueueService/latest/SQSDeveloperGuide/welcome.html)
