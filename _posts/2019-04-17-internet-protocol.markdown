---
categories: blog
date: '2019-04-17 22:39:18'
description: 有关网络协议的一些事
layout: post
published: True
title: "internet protocol"
---

### TCP/IP协议模型

##### 五层及常用协议

|应用层|HTTP、FTP、telnet、ssh|
|传输层|TCP、UDP|
|网络层|ICMP、IP、IGMP|
|数据链路层|ARP、RARP、CSMA/CA|
|物理层|802.11系列协议|

##### 端到端和点到点

应用层和传输层使用端到端协议，也就是说，应用关心的是一端到另一端的通信，比如A访问B的上的一个网站，那么端到端协议解决A和B怎么解析俩者之间的数据，而对这些数据怎么一步一步在A和B之间来回不关心，而网络层正好是解决这个问题，所以说网络层使用点到点协议，这里更为准确的说，A和B不是一台主机，而是主机上的一个进程，由于一台主机上一般会有多个进程，那么A发送的数据到B所在的主机上，为了能够正确的送给B，需要给B一个端口，让B接收到数据

##### 端口号

一般会预留1~1023的端口是保留端口，是给超级用户的进程专门保留的。常见的默认端口
http 80，https 443，mysql 3306，FTP 20 21，Telnet 23，ssh 22，rsync 873，smtp 25，ldap 389，ntp 123

##### ipv4地址

|A| 0 7位网络号 24位主机号 | 0.0.0.0 ~ 127.255.255.255
|B| 1 0 14位网络号 16位主机号 | 128.0.0.0 ~ 191.255.255.255
|C| 1 1 0 21位网络号 8位主机号 | 192.0.0.0 ~ 223.255.255.255
|D| 1 1 1 0 28位多播组号 | 224.0.0.0 ~ 239.255.255.255
|E| 1 1 1 1 0 27位 | 240.0.0.0 ~ 255.255.255.255

##### 子网掩码和网段

ip地址网络号部分对应1，主机号部分对应0，转换后的结果就是子网掩码，所以B类地址对应的子网掩码就是255.255.0.0，其中某一个网段就是128.0.0.1/16,C类地址对应的子网掩码就是255.255.255.0,某一个网段192.168.0.1/24，
看俩个ip是否在同一个网段，将ip与对应的子网掩码按位AND，结果相同就表明这俩个ip在同一子网络，可以直接通信

### IP网际协议

##### 报文格式

![avatar](/assets/images/ip.png)

```
服务类型： 3bit优先权子字段，4bit服务类型子字段，1bit 0，其中4bit分别代表 最小延时、最大吞吐量、最高可靠性、最小费用，但是多数的TCP/IP协议都不支持该选项，但仍有一些协议，比如OSPF能根据该值进行决策。
标识： 唯一标识主机发送的每一份数据报，当某一报文长度超过MTU时，将对这个报文进行分片，这些分片的标识字段是一样的，通过片偏移字段区分
标志：3ibt，第二位，1表示不分片，0表示分片，第三位，1标识还有更多的片，0表示这就是最后一片
TTL：可以经过的最多跳数
选项部分：由于不是所有的主机和路由器都支持，一般为空
```

#####  选路
